const input_text = document.getElementById("input-text");
const characters = document.getElementById("characters");
const charWithoutSpace = document.getElementById("characterWithoutSpace");
const sentence = document.getElementById("sentence");
const paragraphs = document.getElementById("paragraphs");
const words = document.getElementById("words");

input_text.addEventListener("input", () => {
    let text = input_text.value;
    input_text.value = text;
    characters.innerText = text.length;
    charWithoutSpace.innerText = charactersWithoutSpace(text);
    sentence.innerText = countSentence(text);

    text = modifyText(input_text.value).join('');
    paragraphs.innerText = countParagraph(text);
    words.innerText = countWord(text);

    if (input_text.value.length === 0) {
        reset()
    }
})

function charactersWithoutSpace(input) {
    let regex = /[^\s]/g;
    if (input.match(regex) != null) {
        return input.match(regex).length;
    }
    return 0;
}

function countSentence(input) {
    let regex = /[\n ][^0-9].+?[.!?]/g;
    if (input.match(regex) != null) {
        return input.match(regex).length;
    }
    return 0;
}

function countParagraph(input) {
    let regex = /([.!?]\s*\n)/g;
    console.log(input.trim().split('').filter(char => true))
    console.log(input.match(regex))
    if (input.match(regex) != null) {
        return input.match(regex).length + 1;
    }
    return 0;
}

function countWord(input) {
    let txt = input.replaceAll(/\n/g, " ");

    return txt.trim().split(/\s+/g).filter(char => char.match(/\w/g)).length;
}

function reset() {
    characters.innerText = 0;
    charWithoutSpace.innerText = 0;
    sentence.innerText = 0;
    paragraphs.innerText = 0;
    words.innerText = 0;
}

function modifyText(txt) {
    var i = 0;
    let text = txt.split('');

    for (i = 0; i < text.length; i++) {
        if (text[i] === '\n' && text[i - 1] != '.') {
            text[i] = ' ';
        }
    }
    return text;
}